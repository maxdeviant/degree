
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
<title>Data Structures - Maps</title>
<link rel="stylesheet" type="text/css" href="css/basic.css" />
<link rel="stylesheet" type="text/css" href="css/init.css" />
<link href="images/favicon.ico" rel="shortcut icon" type="image/icon" />
<link href="css/java.css" media="all" rel="stylesheet" type="text/css" />
<style type="text/css" media="print">
/* override other settings to make print-friendly appearance */
body { padding: 10px 20px; }
.print_hide { display: none; }
div.print_only { display: block; }
#header { margin-top: 0px; height: 30px; }
#content { margin-top: 25px; }
</style>
</head>
<body>

<div id="header">
<h2 style='margin:0'>
Maps</h2>
<div id="mtime">last modified: Feb 8, 2013</div>

<div id="toggle_all" class='print_hide'>
<a href="#">
toggle show-hides
</a>
</div>



<div id="sections" class='print_hide'>
<select name="sections">
<option value="">--- select a section ---</option>
<option value="#demo">Map Demo Program</option>
<option value="#treemap-implement">TreeMap Implemementation</option>
<option value="#searchtreemap">SearchTreeMap Details</option>
<option value="#map-implementations">HashMaps</option>
</select>
</div>

</div>

<div id="content">

A <i>map</i> is something which associates one set of 
things called <i>keys</i>,
to a set of things called <i>values</i>. The general name for any 
such association is a <i>relation</i>. The important point about a map
is that the relation is <i>functional</i> in that a key never appears twice
in the relation (with different values).

Other names for a map are <i>partial function</i> (mathematics)
<i>associative list</i> (computer science). Sometimes the
term <i>hash</i> refers to a map, but hash connotes a specific
implementation of a map which we'll see later.
<p></p>
Java uses the generic
interface <tt>Map&lt;K,V&gt;</tt> as the basis of map implementations.
The generic type <tt>K</tt> refers to the key type and <tt>V</tt> refers to the value type.
The important member functions are these:
<pre class="lh3 n">
put(key,value);      <span class="ssf">add a <tt>key/value</tt> pair or replace <tt>value</tt> for existing <tt>key</tt></span>
get(key);            <span class="ssf">retrieve <tt>value</tt> for a given <tt>key</tt> (null if no such <tt>key</tt>)</span>        
</pre>
Like the Set interface, the Map interface has stronger extensions:
<tt>SortedMap&lt;K,V&gt;</tt> and <tt>NavigableMap&lt;K,V&gt;</tt>.
Also like sets, there are three <tt>Map</tt> implementation classes of interest to us: 
<ul class="notes">
<li><tt>HashMap&lt;K,V&gt;</tt>: An implementation of <tt>Map</tt> 
in which no particular ordering of elements is maintained.</li>
<li><tt>LinkedHashMap&lt;K,V&gt;</tt>: 
An implementation of <tt>Map</tt> 
in which the
the <b>entry</b> order of elements is maintained.</li>
<li><tt>TreeMap&lt;K,V&gt;</tt>: 
An implementation of <tt>NavigableMap&lt;K,V&gt;</tt> in which the elements
are maintained 
<b>sorted</b> by the key component.</li>
</ul>

<h3><a name="demo"></a>Map Demo Program</h3>

Instead of creating a new project, it is easiest to use either of
the NetBeans projects <tt class="file">TreeDemo</tt>
or <tt>HashDemo</tt> created in previous documents and run this as
one of the main programs.
<div class="n">
<div class='file_display show_hide'>
<form action="#">
<input type='hidden' name='path' value="mainMapOpsDemo.java" />
<input type='hidden' name='lang' value="java" />
<input type='hidden' name='status' value="0" />
<input type='hidden' name='can_select' value="1" />
<span class='show_hide_label'>
mainMapOpsDemo.java</span>
<a href="/~rkline/ds/showhide/target/maps">(click to show)</a>
</form>
<div></div>
</div>
</div>
Use eacho of the top three lines to see any differences in the outcomes.
<div class='format_display'>
<span></span>
<pre class="java">    Map<span class="sy0">&lt;</span><span class="kw3">String</span>, Integer<span class="sy0">&gt;</span> people <span class="sy0">=</span> <span class="kw1">new</span> TreeMap<span class="sy0">&lt;</span><span class="kw3">String</span>, Integer<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="co1">//Map&lt;String, Integer&gt; people = new HashMap&lt;String, Integer&gt;();</span>
    <span class="co1">//Map&lt;String, Integer&gt; people = new LinkedHashMap&lt;String, Integer&gt;();</span></pre></div>

Some points to make about the Map operations:
<ol class="notes">
    <li>You can have <tt>null</tt> values, which unfortunately, can obfuscate the
interpretation of the
return values of <tt>put</tt>, <tt>get</tt>, and <tt>remove</tt>.
    </li>
<li>
The <tt>put(key,value)</tt> operation either adds a new <tt>(key,value)</tt> pair or
resets the value. It also returns the old value, or null if the key pair was
newly added. If <tt>null</tt> values are permitted then we cannot use
the return value as a determination of successful addition.
</li>
    <li>
The <tt>get(key)</tt> operation returns the associated value and <tt>null</tt> if the key
does not exist. If <tt>null</tt> values are used, then we need to use the boolean
<tt>containsKey(key)</tt> operation to tell for sure if a key is present.
    </li>
    <li>
The <tt>remove(key)</tt> operations removes an existing <tt>(key,value)</tt> pair
and returns the value. If the key is not found then null is returned.
Similar to the situation with <tt>put</tt>,
if <tt>null</tt> values are permitted then we cannot use
the return value as a determination of successful deletion.
    </li>
    <li>
The functions
<tt>keySet</tt> (returning a <tt>Set</tt>) and <tt>values</tt> (returning a <tt>Collection</tt>)
 allow you to separate
keys and values of a Map.
    </li>
    <li>
You can iterate over a Map using on either the keys or the entries themselves.
If both keys and values are desired, it is more efficient to iterate over the
entries (an <tt>O(n)</tt> operation) than the by using the keys and retrieving the values
(an <tt>O(n*log(n))</tt> operation in TreeSets).
    </li>
</ol>


<h4>A Map is more general than a Set</h4>

A map can be used to implement a set.
Java actually does this implicitly while other languages like Php, Perl, etc. require
that you do so explicitly.
For example, think of implementing
<div class='format_display'>
<span></span>
<pre class="java">Set<span class="sy0">&lt;</span>String<span class="sy0">&gt;</span> s <span class="sy0">=</span> ....</pre></div>
by
<div class='format_display'>
<span></span>
<pre class="java">Map<span class="sy0">&lt;</span><span class="kw3">String</span>,Integer<span class="sy0">&gt;</span> m <span class="sy0">=</span> ...</pre></div>

To say the set contains the strings:
<pre class="n">
"politics", "beer", "afterlife", "theater"
</pre>
translates into the presence of these pairs in the map:
<pre class="n">
("politics",1), ("beer",1), ("afterlife",1), ("theater",1)
</pre>
The crucial thing is that an element which is in the set appears
with a <b>non-<tt>null</tt> value</b> in the corresponding map.
The translation of operations is this using the boolean
<tt>stat</tt> variable:
<pre class='n lh3'>
Set                               Map
---                               ---
stat = s.contains(some_string)    stat = (m.get(some_string) != null)
stat = s.add(some_string)         stat = (m.put(some_string,1) == null)
stat = s.remove(some_string)      stat = (m.remove(some_string) != null)
</pre>
In particular, 
the non-null values returned by
<tt>get</tt>, <tt>put</tt>, and <tt>remove</tt> 
can be interpreted as the presence of a key element.



<h3><a name="treemap-implement"></a>TreeMap Implemementation</h3>

Our implementation of a <tt>TreeMap</tt> is similar to that of a 
<tt>SearchTreeSet</tt>. The only
difference is that the nodes hold a (<b>key,value</b>) pair instead of single
data value. A key, which can occur only once in the tree takes on the role 
of the element in <tt>TreeSet</tt>. In the binary tree implementation, we 
maintain the following ordering property at each node:
<div class="n">
<table>
<tr>
<td style="padding-right:20px"><b>keys</b> of all<br />nodes in the
<br />left subtree
<br />of node <tt>n</tt>
</td>
<td style="padding-right:20px">&lt;</td>
<td style="padding-right:20px"><b>key</b> at<br />node <tt>n</tt></td>
<td style="padding-right:20px">&lt;</td>
<td style="padding-right:20px"><b>keys</b> of all<br />nodes in the
<br />right subtree
<br />of node <tt>n</tt>
</td>
</tr>
</table>
</div>

<h4>Required Support Classes</h4>

<ol class="notes">
    <li>
This one was used in for <tt>SearchTreeSet</tt> in the <tt>TreeDemo</tt> project:
<pre class='n'>
Class Name: <b>SetAdapter</b>
package:    <b>set</b>
</pre>
<div class='n'>
<div class='file_display show_hide'>
<form action="#">
<input type='hidden' name='path' value="TreeDemo/src/set/SetAdapter.java" />
<input type='hidden' name='lang' value="java" />
<input type='hidden' name='status' value="0" />
<input type='hidden' name='can_select' value="1" />
<span class='show_hide_label'>
set.SetAdapter</span>
<a href="/~rkline/ds/showhide/target/maps">(click to show)</a>
</form>
<div></div>
</div>
</div>    
    </li>
    
    <li>
This too was used in for <tt>SearchTreeSet</tt> in the <tt>TreeDemo</tt> project:
   <pre class='n'>
Class Name: <b>Mutable</b>
package:    <b>util</b>
</pre>
<div class='n'>
<div class='file_display show_hide'>
<form action="#">
<input type='hidden' name='path' value="TreeDemo/src/util/Mutable.java" />
<input type='hidden' name='lang' value="java" />
<input type='hidden' name='status' value="0" />
<input type='hidden' name='can_select' value="1" />
<span class='show_hide_label'>
util.Mutable</span>
<a href="/~rkline/ds/showhide/target/maps">(click to show)</a>
</form>
<div></div>
</div>
</div>     
    </li>
    <li>
    The is new to this document:
<pre class='n'>
Class Name: <b>MapAdapter</b>
package:    <b>map</b>
</pre>
<div class='n'>
<div class='file_display show_hide'>
<form action="#">
<input type='hidden' name='path' value="TreeDemo/src/map/MapAdapter.java" />
<input type='hidden' name='lang' value="java" />
<input type='hidden' name='status' value="0" />
<input type='hidden' name='can_select' value="1" />
<span class='show_hide_label'>
map.MapAdapter</span>
<a href="/~rkline/ds/showhide/target/maps">(click to show)</a>
</form>
<div></div>
</div>
</div>    
    </li>
    
    <li>
            The is new to this document:
<pre class='n'>
Class Name: <b>NavMapAdapter</b>
package:    <b>map</b>
</pre>
<div class='n'>
<div class='file_display show_hide'>
<form action="#">
<input type='hidden' name='path' value="TreeDemo/src/map/NavMapAdapter.java" />
<input type='hidden' name='lang' value="java" />
<input type='hidden' name='status' value="0" />
<input type='hidden' name='can_select' value="1" />
<span class='show_hide_label'>
map.NavMapAdapter</span>
<a href="/~rkline/ds/showhide/target/maps">(click to show)</a>
</form>
<div></div>
</div>
</div>
    </li>
<li>
  The implementation class is this:
<pre class='n'>
Class Name: <b>SearchTreeMap</b>
package:    <b>tree</b>
</pre>
<div class='n'>
<div class='file_display show_hide'>
<form action="#">
<input type='hidden' name='path' value="TreeDemo_all/src/tree/SearchTreeMap.java" />
<input type='hidden' name='lang' value="java" />
<input type='hidden' name='status' value="0" />
<input type='hidden' name='can_select' value="1" />
<span class='show_hide_label'>
tree.SearchTreeMap</span>
<a href="/~rkline/ds/showhide/target/maps">(click to show)</a>
</form>
<div></div>
</div>
</div>  
</li>

</ol>

<h4>Test this implementation</h4>

Once these are installed you can use the first <tt>mainMapOpsDemo</tt> program
above to do a (partial) test by using this definition:
<div class='format_display'>
<span></span>
<pre class="java">    Map<span class="sy0">&lt;</span><span class="kw3">String</span>, Integer<span class="sy0">&gt;</span> people <span class="sy0">=</span> <span class="kw1">new</span> SearchTreeMap<span class="sy0">&lt;</span><span class="kw3">String</span>, Integer<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span></pre></div>
The issue is that the <tt>SearchTreeMap</tt> implementation does not
implement the <tt>remove</tt> function, and so you will get an exception
thrown for that usage.


<h3><a name="searchtreemap"></a>SearchTreeMap Details</h3>

It's useful to compare what we're doing here with the 
<tt>SearchTreeSet</tt> class discussion in the
<a href="search-trees.html#searchtreeset-discussion">TreeSets</a> document.
The <tt>SearchTreeMap</tt> nodes are defined by this inner class:

<div class='format_display'>
<span></span>
<pre class="java"><span class="kw1">private</span> <span class="kw1">class</span> Node <span class="br0">&#123;</span>
  K key<span class="sy0">;</span>
  V value<span class="sy0">;</span>
  Node left, right<span class="sy0">;</span>
&nbsp;
  Node<span class="br0">&#40;</span>K key, V value, Node left, Node right<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">this</span>.<span class="me1">key</span> <span class="sy0">=</span> key<span class="sy0">;</span>
    <span class="kw1">this</span>.<span class="me1">value</span> <span class="sy0">=</span> value<span class="sy0">;</span>
    <span class="kw1">this</span>.<span class="me1">left</span> <span class="sy0">=</span> left<span class="sy0">;</span>
    <span class="kw1">this</span>.<span class="me1">right</span> <span class="sy0">=</span> right<span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div>

In particular <tt>SearchTreeMap</tt> nodes contains 
(<tt>key</tt>,<tt>value</tt>) pairs as opposed to 
<tt>SearchTreeSet</tt> nodes which contain only <tt>data</tt> values.
The <tt>SearchTreeMap</tt> data members are the same as in 
<tt>SearchTreeSet</tt>:

<div class='format_display'>
<span></span>
<pre class="java"><span class="kw1">private</span> Node root <span class="sy0">=</span> <span class="kw2">null</span><span class="sy0">;</span>
<span class="kw1">private</span> <span class="kw4">int</span> size <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
<span class="kw1">private</span> Comparator<span class="sy0">&lt;?</span> <span class="kw1">super</span> E<span class="sy0">&gt;</span> cmp <span class="sy0">=</span> <span class="kw2">null</span><span class="sy0">;</span></pre></div>

The Map-based <tt>put</tt> function replaces the 
Set-based <tt>add</tt> function.
The difference is that both the found status as well as the
previous value must be returned.
This is the reason we need the extra 
<tt>Mutable&lt;V&gt;</tt>
parameter in the private <tt>put</tt> helper function: 
it gives us the ability to pass back the old value.

<div class='format_display'>
<span></span>
<pre class="java">@Override
<span class="kw1">public</span> V put<span class="br0">&#40;</span>K key, V value<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  Mutable<span class="sy0">&lt;</span>Boolean<span class="sy0">&gt;</span> found <span class="sy0">=</span> <span class="kw1">new</span> Mutable<span class="sy0">&lt;</span>Boolean<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
  Mutable<span class="sy0">&lt;</span>V<span class="sy0">&gt;</span> oldvalue <span class="sy0">=</span> <span class="kw1">new</span> Mutable<span class="sy0">&lt;</span>V<span class="sy0">&gt;</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
  root <span class="sy0">=</span> put<span class="br0">&#40;</span>root, key, value, found, oldvalue<span class="br0">&#41;</span><span class="sy0">;</span>
&nbsp;
  <span class="kw1">if</span> <span class="br0">&#40;</span><span class="sy0">!</span>found.<span class="me1">get</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="sy0">++</span>size<span class="sy0">;</span>
  <span class="br0">&#125;</span> 
  <span class="kw1">return</span> oldvalue.<span class="me1">get</span><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw1">private</span> Node put<span class="br0">&#40;</span>Node n, K key, V value, 
                 Mutable<span class="sy0">&lt;</span>Boolean<span class="sy0">&gt;</span> found, Mutable<span class="sy0">&lt;</span>V<span class="sy0">&gt;</span> oldvalue<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>n <span class="sy0">==</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    found.<span class="me1">set</span><span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span><span class="sy0">;</span>
    oldvalue.<span class="me1">set</span><span class="br0">&#40;</span><span class="kw2">null</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> <span class="kw1">new</span> Node<span class="br0">&#40;</span>key, value, <span class="kw2">null</span>, <span class="kw2">null</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
  <span class="kw4">int</span> comp <span class="sy0">=</span> myCompare<span class="br0">&#40;</span>key, n.<span class="me1">key</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>comp <span class="sy0">&lt;</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    n.<span class="me1">left</span> <span class="sy0">=</span> put<span class="br0">&#40;</span>n.<span class="me1">left</span>, key, value, found, oldvalue<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> n<span class="sy0">;</span>
  <span class="br0">&#125;</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>comp <span class="sy0">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    n.<span class="me1">right</span> <span class="sy0">=</span> put<span class="br0">&#40;</span>n.<span class="me1">right</span>, key, value, found, oldvalue<span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="kw1">return</span> n<span class="sy0">;</span>
  <span class="br0">&#125;</span>
  <span class="co1">// else comp == 0, i.e. you found it</span>
  oldvalue.<span class="me1">set</span><span class="br0">&#40;</span>n.<span class="me1">value</span><span class="br0">&#41;</span><span class="sy0">;</span>
  n.<span class="me1">value</span> <span class="sy0">=</span> value<span class="sy0">;</span>
  found.<span class="me1">set</span><span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">return</span> n<span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
@Override
<span class="kw1">public</span> V get<span class="br0">&#40;</span><span class="kw3">Object</span> obj<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  K key <span class="sy0">=</span> <span class="br0">&#40;</span>K<span class="br0">&#41;</span> obj<span class="sy0">;</span>
  <span class="kw1">return</span> get<span class="br0">&#40;</span>key, root<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw1">private</span> V get<span class="br0">&#40;</span>K key, Node n<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>n <span class="sy0">==</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="kw2">null</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
  <span class="kw4">int</span> comp <span class="sy0">=</span> myCompare<span class="br0">&#40;</span>key, n.<span class="me1">key</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>comp <span class="sy0">&lt;</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> get<span class="br0">&#40;</span>key, n.<span class="me1">left</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>comp <span class="sy0">&gt;</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> get<span class="br0">&#40;</span>key, n.<span class="me1">right</span><span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
  <span class="kw1">return</span> n.<span class="me1">value</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div>

<h3><a name="map-implementations"></a>HashMaps</h3>

The <tt>HashMap</tt> and <tt>LinkedHashMap</tt> follow the same structure as
<tt>HashSet</tt> and <tt>LinkedHashSet</tt>.
Use the <tt class='file'>HashDemo</tt> project started in
the <a href="hash-sets.html">HashSets</a> document for testing.

<h4>Demo program</h4>
In particular, start with this simple main function. Add it to the Main class:
<div class='n'>
<div class='file_display show_hide'>
<form action="#">
<input type='hidden' name='path' value="HashDemo_all/src/hashdemo/MainRegularLinkedHashMaps.java" />
<input type='hidden' name='lang' value="java" />
<input type='hidden' name='status' value="0" />
<input type='hidden' name='can_select' value="1" />
<span class='show_hide_label'>
mainRegularLinkedHashMaps</span>
<a href="/~rkline/ds/showhide/target/maps">(click to show)</a>
</form>
<div></div>
</div>
</div>
and have <tt>main</tt> call it:
<div class='format_display'>
<span></span>
<pre class="java"><span class="kw1">public</span> <span class="kw1">static</span> <span class="kw4">void</span> main<span class="br0">&#40;</span><span class="kw3">String</span><span class="br0">&#91;</span><span class="br0">&#93;</span> args<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="co1">//...</span>
  mainRegularLinkedHashMaps<span class="br0">&#40;</span>args<span class="br0">&#41;</span><span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div>

<h4>Implementation</h4>

The user-defined <tt class="file">OpenHashMap</tt>
is an open-hashing implementation of the <tt>Map</tt> interface
defining the most basic functions in the spirit of the <tt>OpenHashSet</tt>
from the <a href="hash-sets.html">HashSets</a> document.
These are the relevant classes:

<pre class='n'>
Class Name: <b>MapAdapter</b>
package:    <b>map</b>
</pre>
with the following content:
<div class='n'>
<div class='file_display show_hide'>
<form action="#">
<input type='hidden' name='path' value="HashDemo/src/map/MapAdapter.java" />
<input type='hidden' name='lang' value="java" />
<input type='hidden' name='status' value="0" />
<input type='hidden' name='can_select' value="1" />
<span class='show_hide_label'>
map.MapAdapter</span>
<a href="/~rkline/ds/showhide/target/maps">(click to show)</a>
</form>
<div></div>
</div>
</div>
Create the class:
<pre class="n">
Class Name: <b>OpenHashMap</b>
package:    <b>hash</b>
</pre>
with the following content:
<div class='n'>
<div class='file_display show_hide'>
<form action="#">
<input type='hidden' name='path' value="HashDemo/src/hash/OpenHashMap.java" />
<input type='hidden' name='lang' value="java" />
<input type='hidden' name='status' value="0" />
<input type='hidden' name='can_select' value="1" />
<span class='show_hide_label'>
hash.OpenHashMap</span>
<a href="/~rkline/ds/showhide/target/maps">(click to show)</a>
</form>
<div></div>
</div>
</div>

The internal structure is and code is pretty much like what was used
for the <tt>HashSet</tt> class. The major difference being the
<tt>Node</tt> class in which keys taking the place of set elements and
each key has an associated value.
<div class='format_display'>
<span></span>
<pre class="java"><span class="kw1">private</span> <span class="kw1">class</span> Node<span class="sy0">&lt;</span>K,V<span class="sy0">&gt;</span> <span class="br0">&#123;</span>
  K key<span class="sy0">;</span>
  V value<span class="sy0">;</span>
  Node next<span class="sy0">;</span>
  Node<span class="br0">&#40;</span>K key, V value, Node next<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">this</span>.<span class="me1">key</span> <span class="sy0">=</span> key<span class="sy0">;</span>
    <span class="kw1">this</span>.<span class="me1">value</span> <span class="sy0">=</span> value<span class="sy0">;</span>
    <span class="kw1">this</span>.<span class="me1">next</span> <span class="sy0">=</span> next<span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div>
For example, using the key/value pairs entered in the demo function,
<pre class="n lh3">
(fashion,5),  (radio,17),    (technology,7),  (television,10),
(movies,8),   (business,3),  (wine,15),       (science,11)
</pre>
A depiction of the internal structure using our implementation would be this:
<div class="n">
<img src="images/hash-map.gif" />
</div>

Underlying our public functions is the <tt>search</tt> helper function
which locates the correct pointer in the node chain for a given 
<tt>key</tt> (or <tt>null</tt> if not found).
<div class='format_display'>
<span></span>
<pre class="java"><span class="kw1">private</span> Node search<span class="br0">&#40;</span><span class="kw3">Object</span> obj<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw4">int</span> index <span class="sy0">=</span> hash<span class="br0">&#40;</span>obj<span class="br0">&#41;</span><span class="sy0">;</span>
  Node n <span class="sy0">=</span> bucket<span class="br0">&#91;</span>index<span class="br0">&#93;</span><span class="sy0">;</span>
  <span class="kw1">while</span> <span class="br0">&#40;</span>n <span class="sy0">!=</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span> n.<span class="me1">key</span>.<span class="me1">equals</span><span class="br0">&#40;</span>obj<span class="br0">&#41;</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span> 
      <span class="kw1">break</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    n <span class="sy0">=</span> n.<span class="me1">next</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
  <span class="kw1">return</span> n<span class="sy0">;</span>
<span class="br0">&#125;</span></pre></div>
The public <tt>put(key,value)</tt> operation adds a new key/value pair if the key doesn't exist.
If the key does exist, the old value is replaced by the new one.

<div class='format_display'>
<span></span>
<pre class="java"><span class="kw1">public</span> V put<span class="br0">&#40;</span>K key, V value<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  Node<span class="sy0">&lt;</span>K,V<span class="sy0">&gt;</span> foundAt <span class="sy0">=</span> search<span class="br0">&#40;</span>key<span class="br0">&#41;</span><span class="sy0">;</span>  <span class="co1">// need to template-ize type</span>
&nbsp;
  <span class="kw1">if</span> <span class="br0">&#40;</span>foundAt <span class="sy0">!=</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>            <span class="co1">// key found</span>
    V old_value <span class="sy0">=</span>  foundAt.<span class="me1">value</span><span class="sy0">;</span>
    foundAt.<span class="me1">value</span> <span class="sy0">=</span> value<span class="sy0">;</span>          <span class="co1">// replace old value</span>
    <span class="kw1">return</span> old_value<span class="sy0">;</span>               <span class="co1">// and return it</span>
  <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
    <span class="sy0">++</span>size<span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw4">float</span><span class="br0">&#41;</span>size<span class="sy0">/</span>capacity <span class="sy0">&gt;</span> loadFactor<span class="br0">&#41;</span> <span class="br0">&#123;</span>
      rehash<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span>
    <span class="br0">&#125;</span>
    <span class="kw4">int</span> index <span class="sy0">=</span> hash<span class="br0">&#40;</span>key<span class="br0">&#41;</span><span class="sy0">;</span>
    bucket<span class="br0">&#91;</span>index<span class="br0">&#93;</span> <span class="sy0">=</span> <span class="kw1">new</span> Node<span class="br0">&#40;</span>key, value, bucket<span class="br0">&#91;</span>index<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">;</span>  <span class="co1">// add the pair</span>
    <span class="kw1">return</span> <span class="kw2">null</span><span class="sy0">;</span>                                                 <span class="co1">// return null</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div>
The public <tt>get</tt> operation is, of course, simpler:
<div class='format_display'>
<span></span>
<pre class="java"><span class="kw1">public</span> V get<span class="br0">&#40;</span><span class="kw3">Object</span> obj<span class="br0">&#41;</span> <span class="br0">&#123;</span>
  Node<span class="sy0">&lt;</span>K,V<span class="sy0">&gt;</span> foundAt <span class="sy0">=</span> search<span class="br0">&#40;</span>obj<span class="br0">&#41;</span><span class="sy0">;</span>
  <span class="kw1">if</span> <span class="br0">&#40;</span>foundAt <span class="sy0">!=</span> <span class="kw2">null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> foundAt.<span class="me1">value</span><span class="sy0">;</span>
  <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
    <span class="kw1">return</span> <span class="kw2">null</span><span class="sy0">;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre></div>

</div><!--content-->


<script type="text/javascript" src="/javascript/jquery-1.6.4.min.js"></script>
<script type="text/javascript" src="/~rkline/js/init.js"></script>




<p></p>
<div style="font-size:80%;line-height:13px;padding-bottom:5px;">
<hr />
<span style='float:right'>&copy; Robert M. Kline</span>
<div class='print_hide'>
&nbsp;
<div>
</div>

</body>
</html>